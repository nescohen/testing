/** @file */
/*
 * Copyright (c) 2019, Cisco Systems, Inc.
 *
 * Licensed under the Apache License 2.0 (the "License").  You may not use
 * this file except in compliance with the License.  You can obtain a copy
 * in the file LICENSE in the source distribution or at
 * https://github.com/cisco/libacvp/LICENSE
 */

//
// Created by edaw on 2019-01-07.
//

#include "ut_common.h"
#include "app_common.h"
#include "acvp/acvp_lcl.h"

ACVP_CTX *ctx;
ACVP_TEST_CASE *test_case;
ACVP_HASH_TC *hash_tc;
ACVP_RESULT rv;

int initialize_sha_tc(ACVP_HASH_TC *hash_tc, int alg_id, char *msg, int msg_len, int test_type, int corrupt) {
    memset(hash_tc, 0x0, sizeof(ACVP_HASH_TC));
    
    if (!corrupt) {
        hash_tc->md = calloc(1, ACVP_HASH_MD_BYTE_MAX);
        if (!hash_tc->md) { return -1; }
    
        hash_tc->m1 = calloc(1, ACVP_HASH_MD_BYTE_MAX);
        if (!hash_tc->m1) { return -1; }
    
        hash_tc->m2 = calloc(1, ACVP_HASH_MD_BYTE_MAX);
        if (!hash_tc->m2) { return -1; }
    
        hash_tc->m3 = calloc(1, ACVP_HASH_MD_BYTE_MAX);
        if (!hash_tc->m3) { return -1; }
    }
    
    if (msg) {
        hash_tc->msg = calloc(1, ACVP_HASH_MSG_BYTE_MAX);
        if (!hash_tc->msg) { return -1; }
        rv = acvp_hexstr_to_bin(msg, hash_tc->msg, ACVP_HASH_MSG_BYTE_MAX, NULL);
        if (rv != ACVP_SUCCESS) {
            ACVP_LOG_ERR("Hex converstion failure (msg)");
            return -1;
        }
    }
    
    hash_tc->msg_len = (msg_len + 7) / 8;
    hash_tc->cipher = alg_id;
    hash_tc->test_type = test_type;
    
    return 1;
}

void free_sha_tc(ACVP_HASH_TC **hash_tc) {
    ACVP_HASH_TC *tc = *hash_tc;
    if (tc->msg) free(tc->msg);
    if (tc->md) free(tc->md);
    if (tc->m1) free(tc->m1);
    if (tc->m2) free(tc->m2);
    if (tc->m3) free(tc->m3);
    free(tc);
    tc = NULL;
}

/*
 *      "tcId" : 1,
 *      "msg" : "EB",
 *      "len" : 8
 *      "md": "A70FB6A9415D3C34A9EA5510BA7E3A055D88AEF9"
 */
Test(APP_SHA_HANDLER, properly_sha1_8) {
    char msg[] = "EB";
    char expected_str[] = "A70FB6A9415D3C34A9EA5510BA7E3A055D88AEF9";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));

    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA1, msg, 8, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));

    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

Test(APP_SHA_HANDLER, properly_sha1_22688) {
    char msg[] = "64FC1AB2AE132D2AC7DEB5BF31986631F10B11B882893BD2FD859C11E779F953346CB92166C2581C075DED6F78DC54B34B05E6393D11B31D1D8074062F3488B54D2E9C864BB236D7454FCA36A75953718CCC466F2F4681D1F204D39D999D6BD19395C8CB4DE17F92741580BFE2A622F11D0EA49B061B4B16F9EA67CA44ABEDC50EADDCCA4A708030674D8A7A5D7BBB59CE184887637A7E705F133CCE11E6E0FF90DE3A9DFFF10965960715858BAA2A35B878B024AA7DA4494ADCBB54D616377DD3162587B173D27F3DF30507C4C94C1A6712E44963B316B565EC11D17046599B0ED94FD8C591489CC214D8C13209365CAD2B9A2FB1465722EFEA19F90F949415B43711FA26FA4601429590BBD6059F7FE62165045B0DD320D475D20C938A3252CFAEC7D2881C7D1330F53D84662B98C1F6AC8442E663C47B0A9A16A30D77F77F1AF7E66FC7962C6A634C682089DDBAEA19E0838B0A4C49B61E8E68B486E1609915C7622116B2A179388E8F3019E20A734F9D856D100D477C18FC21691064F8F27D8202945009889E4D939951C962B240F878197FD4DD1C185BB22A9E51EF0DD1DF5892CC2202EB681D594B2C26A22F429A72591D36D84B104F25973C71A5F799BFBFF4F8A44DB251964F581FEE6B3EF3EF9C434888CC91D3513719D55482B77579399764961EDEDEBBE2EAC7AC9C4868FAEBBE291A71D257248A17832B6E33801604BC36D338DEAEC55EBA5B24B55E68BB44438802CE79356F6B9D74CCA43C753D0E7D0A0504AD3E73C1F894A742C2C2FFE32867E4718E940EC23A8177526FBEF2619EE6775D4CE4AC28F9916388F8AAEC15C73C632FD7DCF5F56752E85A676D535B1C9FEDAFD7C61F8B97BB4D8489761423DBDEC0C21A0F008B964F246C6F43E34615ECFF0DCDC8F488FE7D3ED7678B448CBE589E4AB469481BACBA77CB4F1E08D593B50FCE02D37B7A29742B622AAD460D1B738B781977FC25BB01E149421EFC2AE06985AE9960FF4AD1B7C1B08E031D8D03B9EA4B48E83E1863A92E021D4C31EB25BA66483B4AC705BFD361578F5FCFEA03FE95730922E446B1C0F86166BE1D320E510F5EED218C992DF46E2D2FEFD95B0A94C03B7F403D3518546AC8E4F5F92D01914769BAD97FC43A15B34757FD9B1B89DC565FEC1FC455BACA376CE6C7AEE13BC52ACB0B623860F4AC5B4395F8FF50C1508F92D734F32C5C52CBF23A73719559493F574D5D6C186F2D94DF4B21A886BD71E0585C072B7A1D7828787BA78E898CA6643E7EBDC2A2A8EC9A02AF10A485CB479AC9FDFE3CBD88BE140FFF15050A3043F0EFA673CE573BDE5699C5B3383287288D80B1BFCD7C960BB24C15FD80FE8560B5E7422BAD58C74B88CB7AD2C93A0B2A0C80148A6AE62B321B54CC95A3C3A9D06B8FED435C94A8A10B1CA5F9AFB15F7FE2B9C12ACFF1EFA32B9FC056FAD2682DC42A8329B9EDE3CDAAE37B5A8A56D1DBABC7680BF16DFAEFB8A7303F62538586762F4F818C0B464AC4B297CAE0A84B5BDE22AA7F59DF5D14AB10340038A88042AE5C03D5B2B0FE5547C1EA4F81A6FFEDA769E7E29633E37A0502318A618D0CAF011970DF96F3C5C60540B33C596216DD9B968E4457825B1F3C99C977760396FAFE44B198839A8335AD3F65F2521F14CE7AA88EF7880AF4B3B1F47A1A2973056A32065C6D319085298D164F4C360D13B6B3F2EA7C6EC9015AB2E32909C4114CFD8B9BFF65D6C8C06524FCC18965A696DAFD3F2B76709105326C3236F2F6AA264FA0B5F3CCE810F6DF685B0D73FC6D8CE8D51FB3EA60EDB37E68E876CCA729C03270BDF7F28F6CFAB02A8C6323106D1BE2FEDD1BB7DC960D98A78239E2C1206BCB7F1EE117508BC6F0D690806E855A01A1CB38ED13F5405051D5477E565DD041ABFAE97E110FE71AECF110F72DE7E2E026D896B302CB66B5FE30F0FE6B77B801CDBE68516581DA377E3AB87AAA3E8042D4B3F60E5E9EFF134B4F00EB476555A46BBB36AE2AB7931CE6F45102DFB204FE1B3764C11C23BC046C9208F99EC02CD03D972CAE3D9C7A397413311AA26CA654489EAC7336923C9869744BA4F10730180FF46E86064C9CC8AB9A5359BB2678B737FA00CED93CC4AB1E33FBDA6525D4C76CED401B24DE4E486C85AFFA3E5ACB654EB0CAC5CF9C05500F92645595094D5B9592B3878BC76801C0CF6BDE8CD33D828990E4B380695A2074CCE28CDF0E18D7643CCE7CDC54F632634B2F29BD7A1CF11E4364AEE1B297630E90DB81F9CB4CEFF92859A8C55CC5ED3FC56518CD68B1504DDC572BFE11FFBEE493D8A24235F8C863FC916ECB6ACE766F62C0E1707CF7E6321DB7F294AFEC8B96251393D23450FFA7D694C44EE46E05CEECDBEA9D96E3F827ABD792349F9FF7C1E052396F9C624A4D5D7754741E9109B0EB9133A7AD6BE85E822F347F9E5C1E2A08E3E0EE1EF05F1F8298087E427A57DF563091BEC9FFA4C1405860FC81CDE566F696EE767160E17D50FDA6522D28B7E32CB64C84C215C0F759524EFF6EB01C29EA36A7F95D8396A3B453D38AF6FE138E58CEAC9EF6D09C9D8F4CFA080396D024879D5041B70FB1D85543545EB24F43535B51963ED4A4C73B775E080F5CECE609B286DA3A526FE0EE0D8142BD0B13FC985B56F5E99F83AB61D8A3B097FDBE5998006072AFE89FAA503B35C27F059FDE27F606CEB685E6692435C2D9FCBF1B23CF00485DEA3BF29E2A0C7AD009A7E023B2A06FB3218E5AE05D4BADA186C9B7CA0B3E696028517E97AA285C116644B4D2D749A3B38A2762396171AE69D29CC7861DE015BE7AB86C5554F9DB84C7BC520CB4803E4D50D5AB21FDE41895A7D29185AC23CDB85169531596F3893549601D7A06563C642273AAEB996627CDCD0349DD2F24E4E4365862F1E560C1FAC0448725B1E698F0B0C0AA91080411B35A387658EE4979D185CF619F47EC24CD05B3EFAA1A8205445C3726A8F569B498F8A9DD092DC7ADAFEEA2A7B72BF528D669A0FBBC9C095D3841A41F9BF968732D868C946FC38D6E00708BB378BB47E87CD3201069973A248D19A1979CC71D3BA21A63FE1371FCF7790A92F7C19677DAD940E7B9350A8D9085A0056CBA077893674C4AEF952028638D551BF727BFC593855C9F145A8588ED09F81F3CD4894C9501B9B78629FC367854423FBDF79788A5DCDAF5079C794C1ED274EBCC997DA6CC13138FB065A16D7B633B8DA7A45B61F5C4B9B97A5660A890691C2797789AB4E2EAE319598D4D5E96554C67450AB63BFA0B64664D5F90B02C6C1CFDC338C3C8CB81985EE0566D592B07190B078C15AD67E0605A4066357A48C36FC6E77865AF6053F45AB71D1C5A66A4CC83DAD8749B33047629E8241CC0DC4F7CFCB1D4FEF88AF3E47B2848B2DD0A487E5C2612CAC5C0209AE571F0A344CF1CA269FB26A3E500F395A49D34BCCDEAE71A8B68EBDC7EB9772254B9FEEB209882B0E4159CC524D4E7470390843CE27454E35C113CC68001B806C04A77CD48F62629DA173122CE432BC82F6BDE37BF386DCB8746E147C15DC716386A08509C17B3E1C843754F40DB2A3E58FE234717F170C99A14E5FBD8EF6C506672FEF88284C753B3F628300107E06C41BA362EAD2E8836628AD4646B67D8F173775721486CF88F2DD176A027D3546F785063B0E0E0C7BE9346647A14F42529965003567658BCA56A170E75EC1B7CC705E95890916E4177CDCE7A041163A73C4662BBA49A5A58D0E1F41F2257958C0D4B75DEBB306B8C52F59DB0CF299D998A39660A7928C83CE4A488FC1EC036147D9DA3A2AAEDE0A250DCE46CD73EFC59DD12E0596C132AB1ED20CC9CD2BC68366175EECC827BAC6A92D21DA3D9B55DB0405AB887F7988A6C69261D575873756E7FBE2235EE3DB39699D7F1F67F93D70B77240F472BE8F484AADD093611454184C99D37B1C1D5D44FA2E46FEC1D3449725C2E9D9AF73E0CB66FE30AC38D567A09C30E2AC906343A14BE0786379E6468B4A0968D8B4F0593F3673DE5FBEA";
    char expected_str[] = "85A2D63BF512F8343C3C881B88A95405641FB36B";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA1, msg, 22688, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

/*
 * missing msg in hash tc test case
 */
Test(APP_SHA_HANDLER, missing_msg_sha1) {
    char *msg = NULL;
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA1, msg, 8, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    rv = app_sha_handler(test_case);
    cr_assert_neq(rv, 0);
    
    free_sha_tc(&hash_tc);
    free(test_case);
}

/*
 * the pointers for md, m1, m2, m3 should be allocated
 * by the library. here we don't allocate them and test
 * to see if the handler gracefully handles it
 */
Test(APP_SHA_HANDLER, disposition_mem_not_allocated) {
    char msg[] = "64FC1AB2AE132D2AC7DEB5BF31986631F10B11B882893BD2FD859C11E779F953346CB92166C2581C075DED6F78DC54B34B05E6393D11B31D1D8074062F3488B54D2E9C864BB236D7454FCA36A75953718CCC466F2F4681D1F204D39D999D6BD19395C8CB4DE17F92741580BFE2A622F11D0EA49B061B4B16F9EA67CA44ABEDC50EADDCCA4A708030674D8A7A5D7BBB59CE184887637A7E705F133CCE11E6E0FF90DE3A9DFFF10965960715858BAA2A35B878B024AA7DA4494ADCBB54D616377DD3162587B173D27F3DF30507C4C94C1A6712E44963B316B565EC11D17046599B0ED94FD8C591489CC214D8C13209365CAD2B9A2FB1465722EFEA19F90F949415B43711FA26FA4601429590BBD6059F7FE62165045B0DD320D475D20C938A3252CFAEC7D2881C7D1330F53D84662B98C1F6AC8442E663C47B0A9A16A30D77F77F1AF7E66FC7962C6A634C682089DDBAEA19E0838B0A4C49B61E8E68B486E1609915C7622116B2A179388E8F3019E20A734F9D856D100D477C18FC21691064F8F27D8202945009889E4D939951C962B240F878197FD4DD1C185BB22A9E51EF0DD1DF5892CC2202EB681D594B2C26A22F429A72591D36D84B104F25973C71A5F799BFBFF4F8A44DB251964F581FEE6B3EF3EF9C434888CC91D3513719D55482B77579399764961EDEDEBBE2EAC7AC9C4868FAEBBE291A71D257248A17832B6E33801604BC36D338DEAEC55EBA5B24B55E68BB44438802CE79356F6B9D74CCA43C753D0E7D0A0504AD3E73C1F894A742C2C2FFE32867E4718E940EC23A8177526FBEF2619EE6775D4CE4AC28F9916388F8AAEC15C73C632FD7DCF5F56752E85A676D535B1C9FEDAFD7C61F8B97BB4D8489761423DBDEC0C21A0F008B964F246C6F43E34615ECFF0DCDC8F488FE7D3ED7678B448CBE589E4AB469481BACBA77CB4F1E08D593B50FCE02D37B7A29742B622AAD460D1B738B781977FC25BB01E149421EFC2AE06985AE9960FF4AD1B7C1B08E031D8D03B9EA4B48E83E1863A92E021D4C31EB25BA66483B4AC705BFD361578F5FCFEA03FE95730922E446B1C0F86166BE1D320E510F5EED218C992DF46E2D2FEFD95B0A94C03B7F403D3518546AC8E4F5F92D01914769BAD97FC43A15B34757FD9B1B89DC565FEC1FC455BACA376CE6C7AEE13BC52ACB0B623860F4AC5B4395F8FF50C1508F92D734F32C5C52CBF23A73719559493F574D5D6C186F2D94DF4B21A886BD71E0585C072B7A1D7828787BA78E898CA6643E7EBDC2A2A8EC9A02AF10A485CB479AC9FDFE3CBD88BE140FFF15050A3043F0EFA673CE573BDE5699C5B3383287288D80B1BFCD7C960BB24C15FD80FE8560B5E7422BAD58C74B88CB7AD2C93A0B2A0C80148A6AE62B321B54CC95A3C3A9D06B8FED435C94A8A10B1CA5F9AFB15F7FE2B9C12ACFF1EFA32B9FC056FAD2682DC42A8329B9EDE3CDAAE37B5A8A56D1DBABC7680BF16DFAEFB8A7303F62538586762F4F818C0B464AC4B297CAE0A84B5BDE22AA7F59DF5D14AB10340038A88042AE5C03D5B2B0FE5547C1EA4F81A6FFEDA769E7E29633E37A0502318A618D0CAF011970DF96F3C5C60540B33C596216DD9B968E4457825B1F3C99C977760396FAFE44B198839A8335AD3F65F2521F14CE7AA88EF7880AF4B3B1F47A1A2973056A32065C6D319085298D164F4C360D13B6B3F2EA7C6EC9015AB2E32909C4114CFD8B9BFF65D6C8C06524FCC18965A696DAFD3F2B76709105326C3236F2F6AA264FA0B5F3CCE810F6DF685B0D73FC6D8CE8D51FB3EA60EDB37E68E876CCA729C03270BDF7F28F6CFAB02A8C6323106D1BE2FEDD1BB7DC960D98A78239E2C1206BCB7F1EE117508BC6F0D690806E855A01A1CB38ED13F5405051D5477E565DD041ABFAE97E110FE71AECF110F72DE7E2E026D896B302CB66B5FE30F0FE6B77B801CDBE68516581DA377E3AB87AAA3E8042D4B3F60E5E9EFF134B4F00EB476555A46BBB36AE2AB7931CE6F45102DFB204FE1B3764C11C23BC046C9208F99EC02CD03D972CAE3D9C7A397413311AA26CA654489EAC7336923C9869744BA4F10730180FF46E86064C9CC8AB9A5359BB2678B737FA00CED93CC4AB1E33FBDA6525D4C76CED401B24DE4E486C85AFFA3E5ACB654EB0CAC5CF9C05500F92645595094D5B9592B3878BC76801C0CF6BDE8CD33D828990E4B380695A2074CCE28CDF0E18D7643CCE7CDC54F632634B2F29BD7A1CF11E4364AEE1B297630E90DB81F9CB4CEFF92859A8C55CC5ED3FC56518CD68B1504DDC572BFE11FFBEE493D8A24235F8C863FC916ECB6ACE766F62C0E1707CF7E6321DB7F294AFEC8B96251393D23450FFA7D694C44EE46E05CEECDBEA9D96E3F827ABD792349F9FF7C1E052396F9C624A4D5D7754741E9109B0EB9133A7AD6BE85E822F347F9E5C1E2A08E3E0EE1EF05F1F8298087E427A57DF563091BEC9FFA4C1405860FC81CDE566F696EE767160E17D50FDA6522D28B7E32CB64C84C215C0F759524EFF6EB01C29EA36A7F95D8396A3B453D38AF6FE138E58CEAC9EF6D09C9D8F4CFA080396D024879D5041B70FB1D85543545EB24F43535B51963ED4A4C73B775E080F5CECE609B286DA3A526FE0EE0D8142BD0B13FC985B56F5E99F83AB61D8A3B097FDBE5998006072AFE89FAA503B35C27F059FDE27F606CEB685E6692435C2D9FCBF1B23CF00485DEA3BF29E2A0C7AD009A7E023B2A06FB3218E5AE05D4BADA186C9B7CA0B3E696028517E97AA285C116644B4D2D749A3B38A2762396171AE69D29CC7861DE015BE7AB86C5554F9DB84C7BC520CB4803E4D50D5AB21FDE41895A7D29185AC23CDB85169531596F3893549601D7A06563C642273AAEB996627CDCD0349DD2F24E4E4365862F1E560C1FAC0448725B1E698F0B0C0AA91080411B35A387658EE4979D185CF619F47EC24CD05B3EFAA1A8205445C3726A8F569B498F8A9DD092DC7ADAFEEA2A7B72BF528D669A0FBBC9C095D3841A41F9BF968732D868C946FC38D6E00708BB378BB47E87CD3201069973A248D19A1979CC71D3BA21A63FE1371FCF7790A92F7C19677DAD940E7B9350A8D9085A0056CBA077893674C4AEF952028638D551BF727BFC593855C9F145A8588ED09F81F3CD4894C9501B9B78629FC367854423FBDF79788A5DCDAF5079C794C1ED274EBCC997DA6CC13138FB065A16D7B633B8DA7A45B61F5C4B9B97A5660A890691C2797789AB4E2EAE319598D4D5E96554C67450AB63BFA0B64664D5F90B02C6C1CFDC338C3C8CB81985EE0566D592B07190B078C15AD67E0605A4066357A48C36FC6E77865AF6053F45AB71D1C5A66A4CC83DAD8749B33047629E8241CC0DC4F7CFCB1D4FEF88AF3E47B2848B2DD0A487E5C2612CAC5C0209AE571F0A344CF1CA269FB26A3E500F395A49D34BCCDEAE71A8B68EBDC7EB9772254B9FEEB209882B0E4159CC524D4E7470390843CE27454E35C113CC68001B806C04A77CD48F62629DA173122CE432BC82F6BDE37BF386DCB8746E147C15DC716386A08509C17B3E1C843754F40DB2A3E58FE234717F170C99A14E5FBD8EF6C506672FEF88284C753B3F628300107E06C41BA362EAD2E8836628AD4646B67D8F173775721486CF88F2DD176A027D3546F785063B0E0E0C7BE9346647A14F42529965003567658BCA56A170E75EC1B7CC705E95890916E4177CDCE7A041163A73C4662BBA49A5A58D0E1F41F2257958C0D4B75DEBB306B8C52F59DB0CF299D998A39660A7928C83CE4A488FC1EC036147D9DA3A2AAEDE0A250DCE46CD73EFC59DD12E0596C132AB1ED20CC9CD2BC68366175EECC827BAC6A92D21DA3D9B55DB0405AB887F7988A6C69261D575873756E7FBE2235EE3DB39699D7F1F67F93D70B77240F472BE8F484AADD093611454184C99D37B1C1D5D44FA2E46FEC1D3449725C2E9D9AF73E0CB66FE30AC38D567A09C30E2AC906343A14BE0786379E6468B4A0968D8B4F0593F3673DE5FBEA";
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA1, msg, 22688, ACVP_HASH_TEST_TYPE_AFT, 1)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;

    rv = app_sha_handler(test_case);
    cr_assert_neq(rv, 0);
    
    free_sha_tc(&hash_tc);
    free(test_case);
}

/*
 *      "tcId" : 1,
 *      "msg" : "A8",
 *      "len" : 8
 *      "md": "450C67B531DB6FDD8133001FB1BA337900E79C299CB4812FE183ACAE"
 */
Test(APP_SHA_HANDLER, properly_sha224_8) {
    char msg[] = "A8";
    char expected_str[] = "450C67B531DB6FDD8133001FB1BA337900E79C299CB4812FE183ACAE";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA224, msg, 8, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

Test(APP_SHA_HANDLER, properly_sha224_32192) {
    char msg[] = "6B3EE4F2CE3D0F805C25265DF606EBA017B276D04CAA772F629C8B5A9234C7F2A2275AFAA5A451B1982D10BB0633ACB2FB12B470AA7DC4C63889961FEEA7AE6CE02D90A3B8E6B3CC23204E1070B0B9F9BC7A0240A1A72033CA13E1587175D2E63D816BBF2C692CFD535518CBB18ED91AE20795C08EECEE4BEDBD0CE5E406223CEBFF9F4ACA9B00513A902C8FF30DF0D7F8C55F93B1BEE6DDCB365A2DBA668E80E50BD8A166D2DF419B467E75C9BA8247EAC74C72860748C4A1051CAADC9B98B906F5497555DB9F4437E59BF98288E2E8E137C8522094762E812D7D06161726363F00FDABA2637EB31A6C06FC36C9F11F0B33C203D2D7B903A1EBD8D48FBAB03EE2D1C274A7EE1BA33A9A2AD998171A5A010CC0C75509080274A49ABD07B94E45469E145023F32BCCFA180CDADA2EA83CA8DF8DDEFFF6DDF722E667D3BA15BB477505084153C33A8EEAC0BE33002BE9DC7854D3C200C44B4EDF68135E82168CB84B0D05C40B20907CA28DA24B45BD5F3644E9E946CE07547BCA1461E43FDD1C8D0B03F060612EC6619BA1C9543F1563414D533B9FA397BC3B6D67F2D1822C1D6CE2E161A8FEAC8A7F898DDE8A42C1E2BDE6E4115D49FF6E6CACEE0CEBAE4FEE792C0C1621D349255EB0849E1204692A7A53A12171A64978F90334F2240A3A04279FE2F36C3C355E0755B7A6C2F871A09F131726B2778E5C2078525731517B1557479783A5083E92795498FF0269F14B5A6543A020914CBE2387FCAACEAEB2A054BA10B444CB06E2B338B8FE35B1E41C232005E4F1D0D068FBDB4FABEBF1CA3153CEB0E686156C604A3570F1FA489A7233E79C98E0056E05A197CAB02C51182429B247D0241704C0B9E6E960D571FFC58C7CFC0316F4E39A9ED4FE8AD5254634954562F90E26EE30EBB28DC39F0DD99F219FD67285AD6A8CAB55F71247EF7346AA896EAF11206563EE82B180808FEF96E74579496CF0BD03F5741A738ADDB29C330D528EA3C1E59BE8436343B15F00C5C881F0F98BA654FD181170F6BB4EA651C562E08154B817D73F05EFC0EDD615656AD6C2312F77FE138FA747BB9824A0D8035019C6C56B9C8BB21F708ABAE3A45FCD091B5C27AAA2DE29A5ECF143CAF7B08FAAA49236E26E8632E9DBD15628B97C988A8590D53083A7E250A933F2CE758EF1C7B2735F3DEA5399F18CAA52852ED2D9DFBFB859E877421E03D020350777BF942E5685FA925B5843DF784C72A1ABB370DF3B698D09BD474CAD06BA962D32113DFF4BFE389FB114494DC11630C3F024BE664D6819B5BEDF2D8F24ACA7A4A505F5A81063C56A1ABE47541F4CE8EAD7705AAD5F3C3227BA4E621068525DF9696899AA0107344AD11DA38090D30321F095E282A6100C3FAFF6AF45AE9687BD3ED728236ED880B9F300BD6C7CE21E699310A7F0109CD0918C088381C0274B8F891F63AE3D97329786F21F76A299473378706DF92611DDA28665BBA07006AB12776005C41697D9000ACD02ED3E56F747A8F4886B3AC2EF8EE3794617983D6588DF5DCD9AE0F02800DCA7BC15A0C11BCC7C53DDD68F8B7044FAE5B43E97B5A8C6E3A2AE5A23749B86CB17F7AA07EA7498B7DDCD4003492B8EB8F00E7B77F317D351C3FF145AD2AA4994E11FBB19283508602C31AF89FA8AE3B7082DCDBD2F67EAD210D23CF3D4C4E98D563A8D2CE396E5BDCCABDEDEEAE32400F2E91EBB379FCF6E4B9EAF0DF3D50B0A109A6C1E8AD5A127E9045DFFD63671C0DF2FC8E0CFF927C259170284BECEC229AAB5155CA30430BACAEEB55F6228864D236DDBB6FEB6C025F61022BA906B169E63C0285D84942EBBE6C697901E1DD27BD192F0D46C26E9D21299F0D1BF1681617ED37C35A458E0134247DCE888D2BFE6E1E1D012CD9571E0F5CCB565A87003C2AF1F62DD04B45DA2A5BD69DE07DF9EC8FF9942C2D93181E1B181E901FA85D1AB26E4C8279ABE7F24A4A9444E772362DFCDB0EA791C29A77747FD9B84D8014CE90CE0016ABE6C78EA125EEB80A9C8DF4D06C202476FDD8C274E869313A89282902AED16567069A2D0F75A57A850F5FEDA1143175B9176D6233771D3603C70446A063C76A8A3F1911E1E93BD4501C39921E7D084ECFD89CCA095BA480187C063B59F596CEA17E5AA963015E55E166CDD7F735B21A025E4C473268D8E4E87C13303F1D3B2DE430C7C0870AAD0C1FCF32D2308CFC2BBC455895237AFF694EE1B4000D7E1514490E54E3516E5F5AE36FB221D217C69C7C10BE5431843C4914193ED655806BD1F104FA0719784C6A998A195FC413827DC819907940062943056E5BADD8E8E50CCF863554958EA60C9A0E6A6AC731A77FC707CF4A8D3B5826699F95BF74D668F3E4D0917B93498587541DA4A83C82D29B2DD07441DCD9DD50F1C89E1B15FA2A3EA696ED99DCD5503B499C146A8C49FEF7BAABB9AF151F8AD27A7E40E374DF23688830F23B8A8D46E77F995167BC57CF32BC12EA3962B27FA8C2782723BCDFC4AB03C0C25B8CAB1A94E52C5184B85D5A91920DC3497A27394A9C8ED695222C03D11E09C506E961407F6C5460AC0D0C27A91D495FB0B0E2A4C8D7BBCCCD1A76F955C85E80D00667DAE1CE743C1EF000F6594BF11C2B81CC3FAEE9DB7EC4530EE3987360AD035563AA2964D18CE0819EA446701FDC0E0F7CB66551E643B0914FC34B54BDBD94577669280F2B98383191852D8C1014165A484631050479CE9BB9450D09BE7206BC30668426264655ADBB79DBA4DF69E64CCCF9D6B469C4CE0A9F4E557145F3AB6D3A0CF60650E3441F0A9AD9C2846DDA0EC6430D59DF30B9266CE5097A555048854C5002B978AC9FDA53A5F522FB2AFFA8B8AAC19E88F7BD4CB66EA2F0BDA7C50FCDD4FD740692B997E186419C8D7F951FD5C7122A50165A39C4195C22347160A54272A2903AC56FDAC521B4E32181560280E7721E4D077270653839766D8EB99679732DD38225F747D56F21D296CF620D8FB9A0FE17DA28605624B6321D4539F7044BA2939EE5CC31E589E87577D8A52B6A56BBA785CDD21C16BCB94E57ECD1CDD4A9AB3BEADC644B5126BBF9E63F2D1F731E1EFF130EA0BF779D7FF3212D58A173DEB4A4E818498955CEB6267D59B996AFEA6BA08E559C895E83442465BA0A175D2943AFC5DCF9EECE9D54AF97FF32BBC1D5AD3B34A5CAC77E8A71D1F70826AA7E4E25B0158B6C5D15A056592D1B03C0654B3C8C54885572E9592B322A0F8F14F671CAABCFA806FE6201B39A28B420A9BCABD1762D1D1C48E9E5581C89DE6EC93A7F0D4DC4C06C46C159A960C14F683165A51098D8B993F3BF8F6C3BEEC8581B7284D980E5864EDD34BA3FB100CBD8561146D4D1F9D15E140FE2C403ADA0F0F10ABA3C99A589783A770A6A26CD93E6839309DCEFC962C5BF2E8F1A6DC0C5E7AEE10D44E74F6B6FFE269E34BF807C931A5094D9854FE20E5FA18C051587AED8BBC9FAA360AE37186C9F2CC1C7B2673B3394921C9981A199946DF32E67D7FF1AF855F726CBA027AC7D3E5B26E9767C42CFE3ED0492A73EB2E0B653885AA456C7B606384405371F10A924C3D834825FF7F65DD2BEAFB52130AA0C6DDAC0C0D131069FB9496E7290A2A28CB9B3E7D8BF5E9124493BD55D676F5FA6B6A5E9C19D52E8ABA0F3E0F11C4F89B81C071470D760A247AC5E23C9DCB7939A3A7AB22A5ABE93DE34CF3961A63D727CF5B2050AF98A1168C0347031311D6AEA65872E9EBC8F6A11121DFAF8C9728C1C9F54E73791F91169096EA9B4DFA5EC2FB802E4225A11C1ECE9A6F41AE32AD779F94FD72D4D22ED49A978A08E6C53C80638EE13A0FC856C6672245A8F42CAD1A9ED160897BC151DDBA3D0A7B6784411442646E5C4C4C48001E793325AFE912A513F28C27D97EE5D1EA2E8658C8753F9B48F59107D2C10C2BF83A0860933B0C4096D3F0A71F8909D36B401E5977413A26D9C661BB2AA879049AACB1E25250120888FD9A039B1962AAB1BBAF4BC6A6D7AA1D5AB0A544943E30D68CC18233BA8F1B8CE4004EEC57808A6CA65068D950905B2EE59DE16B9EED884C865B1CA3CE500124899C5602058FBA3C1C44311D8AB631A8645084BBB4A4283B02547B12BDA6B0D76DF3908239C07F6959960FC7288BA0026DD94A7E276E17191E90C285F914D22B0B59A82BB99F82AFCFAB2ACCBD46CBC5D974268FD2BC31161E4921BB6F4E158362CC0EF3507A7694681C3A598436623F4C31D30E9834F81A4DF9A53034EBCB0A05AF021F8618F6AD83BEC4CBD67E0FC37955A63A581A3264EC940B4727FA532CE810D894FADB95F36C2C28CB99E5AE5940CD2A8717B31BDD43FCFB1B0B63DAAB8A5DB084D85091A3DDBEEE74F77661E7B017AA02A6DD8A9895B0E48B7F73B25BA12041FACD5F70EACFD065A24CB08D27877A8FBDBE7BCCCB587EE4493A607343613B25859DE8613FD4687D72A8E3177AF91FEBF2B61397C6A5DEE32F9F45534D420E85632B8746736C45D0554171AA3CAD838E8EAEB651E69F500CE45CCE85A5BEBFE3521FC4FE87AD9AA908FA3616B1C340FE25EA110D2661A428290EF30E164DCA8C57236D7CABA9789FBBDDB28BC7791BD76AE5D36F4A1707C09B6FA7FF4D5686BA86FE8FCC9AAAE3F8595B242D214097D00E41649C08518AE7EF08278EA2D2FBE00AD4CC5F4A2919CF81DCC0D4FEF6C8C2FE49D14936908F525DD9F6B47964D51A302324E903951AE08A9B2D98A3E8C1E5BCA0F377EC2C042EBECFF5640AA36AAE7464BDC0DC8463F1C1BE753BBF4D22533E0057E4134A7FEEE3006E6787DB9F00D6ECE5C63BFFE6148506C16C1AE72F2C377C40A9A4419B5A2AF8BFC298E9F7832B9022EF7959CF7EA9FB25AEA4AAE6A2C306507E5ECA91F9DC5F1F0A7D8F0FAAB56516018AF23387FA9E73353A77B94A033C52A894ACE94192ADE2ADE1CA1C1D3060265DF4EADF15AFE42B470B23A6BE0C01D49AAD400BDBC30BEC6A08E26B26E67F58E136C64BD8D6FFE89F88AC4C7E17EA8F4DF0039D89415D2440C3B6159883B3F458A1BEA99C4EC59E4BC94D38E74BAF201D7AEFDADBD8F9A0DF629A9E744BB2ECC194982D38080A3CCADF7682E23C86DA612B604A707589F1CFF7B1A78B8F7DC14C2F756E26104C7EC55F4F64C9C997910A252EF20CFF1B3703BF3E8487D09C1A433F4C79CE91008F1D6C4A8BAC8CB00E7B387727AAC00099A844FF27A069EB10EBFCF079D712CA814DD8B20D98C47B02E6DFEE72E0881633B9248C99124D67D07AE250288E96ED69AB58AFC0F4BABD35DE1274073965F23C247F10C57C76DAFD98A6C756F95A155AE627D8D3C43BB3C9E9080FED4AFF7642384A82A4F1D491832B74FBA784A73EEDFFBF07B0A72B86A72302990EF90571934D4CFD3747151AEED880FF4AE2D6CB831609F2BC93C48E3681CAB90BC369032ABEDE7E502B54F7F27B9B7536620871DD0D5D77FD303072CB9C288C3E08958A4DB6615254B4D9E18E0723EC05902B5F0E09C1A14DB6BA8B1132322A0CE3FE1668A10561C1167B9FAFAA2EB8BC42A5FEC734703D1EFE2B52182269CF53898BBDBFE02EAB8EF2947E46E09F7909D2AE7A0285B497A0BDF6964C94535595C27F4F23388A6BBCA8837BCC10FB149478E76C77FE92D2D9AFF5494BEB53126D608F42F434F1F03E267895588D47960741829FA6C1B6240474841428C891353DDC0813A60355";
    char expected_str[] = "44FAD02F248A0F8206833FC2FA003E858252A6A7938F92E509BBCA26";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA224, msg, 32192, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

/*
 *      "tcId" : 19,
 *      "msg" : "5CDCCF43DA6ED6686F36625EA4FC5C7B59DC99",
 *      "len" : 152
 *      "md": "A928DF14AE6B032FEFE173B82815550A58D1893108EA22047CAE31EB8E7AD5EC0A5D8CD1C7F22141B028A146A984B62B"
 */
Test(APP_SHA_HANDLER, properly_sha384_152) {
    char msg[] = "5CDCCF43DA6ED6686F36625EA4FC5C7B59DC99";
    char expected_str[] = "A928DF14AE6B032FEFE173B82815550A58D1893108EA22047CAE31EB8E7AD5EC0A5D8CD1C7F22141B028A146A984B62B";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA384, msg, 152, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}


Test(APP_SHA_HANDLER, properly_sha384_73888) {
    char msg[] = "C80AE3FD1CAEFBE3DC4C9ADC646844DFE41103D854BE04F460DD12485D9CE69BA5096535C06CFB4603F9365D3F27FAE9733BC2D9FA31792D3FA36A18F5FEDD12AAD9035E52B81AA7EBFE0ACEEC4497CAF507463BAE9075A867B7EDDB13E6450DC822A1D7F1EFF1BA76716970DAE1E52D7F7DFE3A0CA5354CB1F54E43729118546EE4B0D2711748F44152E0E4DC269EB6FB606C2C3BB4F279F413EE3AE4330D565646967898E08DEBAA3AEEFE1E2A5F9F2F33767FE76F9B055D49B2FF03F22F3051FF0E3CC5CDE971E0549BD6B94FC2A713F12C13635E5664825C4682526E404511A84DE0D173915B46DADE3ED31D61A3CB056D433840D89FE0E0AF5729304CBE926FF41BF38DAC813564543CFD364532B370B39E2CD3B506C3416E7EF4C6C09B16DB75195015147EA39A17ED469BE04F5FA31EEACB639A08894430070C501B4C529BD8DE86A4D5D15A7E01C6DB3E4BF3497BCE10131336EFB9FBBE25E66EFDA560F22B928F29CA2EB431FD01525403476A167609F57C3F7E2D670750D28A035880541ADE85B50ABF84C48C52916357C14B91AFEAC67EF97BD1B14899E94EF341848F65A9164FD81A013C87EFF8102F7501F09FC5CB88E7E6FD302E5ED00BFC0CB48563C1D958B2EB577B72AD64F7ACFF0F18A4E55BA7C6E8503E02C83A2F9573EAECE6A4103F8EA5D6FA6D91703725FFF9688D667FE7F89B29730067FE89E6C40CE2E589F7A5689C7F24CC5442F05B50A6005120F3A256D075DD4A79DC0DC9A24EAF81CC88CC004B898108D6B76E7974ECDC75C82B35748EAF6D55F7F1F21E88FA83C2BB64482C1CC87D556730053ECBD53B6BFA96C426116BE614B4E8C8C8DFE939DCF53A4EB058D60C8C5146DF74C3223EBFBAD207C2D679FC0A14A0032954CF9C47A5C9600A95F63D01589A9F0E75FBB5B7111D987C30DFA55644E3A696D86426F154557079DA50DD524E38A27BCF41EDBB36DB8D7BC1F19D16423A5B72488C39FA166F4F63B6EC939F99596DCEF6E8919F56EF22125F3C60A4B927656DF076ACBC06986460E044AA59EDEDB82195573DA8A84BE9F54840937ACF30A76145808D517B0325349039EB3FE46A52F2B630D46189AAED7EC727BF2CCCF499CC838FC440E06F526AB8C65296CAB01C076C5F6E69FC2BF009C06EC0CE6DDEFAE3CFB5F00172BF52259AD18C79B4AEEC88F52C0AC7D76982739036FF3294ED3B45400744B6391234772646D37E9F8040C0A054BBA8233BEA146C2913A636786B6E502BFAF46E8CDCB1D52D02C27DEE9DA3DD36AA005B8B703BFCB34316C409A42908506C3C241DF64B5417339477E6C7AF3FD7B0DBA174BFBC681F1265D831C808C179A9449DDD7B8E114C741A48D85B0E181B478C1266A2B1950A19A0AB0898C9317C6CD2F5DFCB8764C241442654C781C0BE6E70FAFA852E4C9E246864E05053919A6F0F5A1BCC868C42879794EF4FBA727E81FC5B2963A18BC7EEC16657CAEC5AD533760F39FF41BBCA995E9B10F53A608BBF2FCCAB29C4107F49595D875025A122A88929B04532AD4EA885ED7320D5214C49B77C6B0F035F5D26556CAC90634F87D2BBE61686A9423C9ADBAE882136D4B506EDEB9FAD73DE8EA0AF5A886E4829560D0FAAF58B273A34562ADEED91000D80DDDAF4B9BA5C977CB0713EC0DE996679C940882EB6B290FBA7A5FC44F08F00DF703821D5C1F397963E61A71B23E1DA536ECF7D91DF7DB8FFB0B6AD51F3D5DD588C62A2B9ECD54847D268AC6FB240B255F6EF1ACDE88C4112F10EAA0A3A69FFEBD0595CD536D043889D661E2090AA0D5AC0E7BAF2C1AEB2E937D98A2F5EE5ADF0893D1AC09B723CB1E2DB7C9A7679EC7C3E08EFE75A8828EB19F748738225641900949A7C274B62B0CF147AE99ACCE0804C0C55C2FFAE8523B9410BFE230CC65DC5166756FA398893CBEF96DFABE22D25F56C7F4882293068EB94B5AFDF2E9F65F426CBC7F2D5ECCC54D8EC2F1670B76FF0EB2CC371BA8390DE592CE705DC6CB71FAC5062511E11212FF10306BA0EC2177BBB8B4BE5BE1245891CE503F71CBE57DEA63ED888322A7C37118184000CADC35D2303C4344B5E5D85D9957C9A4833B175031267D21F3B7E7FC097431C971E1E99804C2ACD345AF10E11F8C4B1AA3DCE559E1C1E2A4643AA4ED0F88E3D6C6F7E9D4626D717884F91213DAE16CA8A4F784ED4B08B16BC64BF5864B31CC57C2FBD27C34F00228BA3062932DB8F069B0E02EDBE0A6C299641ED464963BA8F79C4FDCDB5B2D88C3C365940DA2258A9AB09BC1F42968A79FC72D99BDC3D59E5E4E04C8A853B10582E45844884699B70DDC983A3499F6FC54F8208C50A06D2C17FDEAA769235732FAC05BEB25CD9FB0537E3A2AEFED8C48E57DEC0F86ABC5DECF8E0217F6ED3548077827B0D2DC7A30F7A738268F3CAA1A05E1849E6B6EAB12813EB7AFFE87678B94B96789F7922A7A0C476E21CE571D872E00AF5E78CA016F021F52FD46868865D8F67D9CC3C81AB5400D686CCDAD31D43C0E2686FD308202562B5212576A7774B43BDEF02B499544879C9F0ACC578A5421AA67CDFB3C91B7F698E6590C9251DF0834B45801638E93DC11C38EE878AB3C745EB4A9398FA96883E063A9ED71564B2B777377840EB2E653915D94A515985A42C3CA62ED7D468BAC4856B449D23539A668A470D2FDF04EC19226801B45B0EAA4AD8C12AB0CB3CFF84665844D74787A1168EA56003CF7CEE6656FA13D3ED211CCA438C24C469280CEA4BDCACCE6A4214353BEED577D8EDD6FC8693D8D8264A611226AF1A5CBDDD04631D38F0A67974FA2FD23A1D4E3343795DE8E2A26E8C2A223B8325436572E76F593D09BB524ABFDE290265024986E53869148C432D37426DD98B3B66589EFD95D583A3346CAD8EE92C0FD9B0F903AE77EA7EE16207BCF3FD717568E134EBEE03B35F06F7FDCFB64B7793FF2034B3E3416D705246A1B0F4DB7AA10323F8067D2B2F0E63DD451BE83CC58212FB976E9F749861E8B1171E11163C4B13E60B7CCD8A8E978ED3277BA355226965B2C730278E880E9FC6900CC3BEE28B59E8700AA52A35DA2CBFFC2782372778BDDADCF3A2953484F1B0A60364BB568BFBAAB3CACEE04442A669C65B1279BF45C9F5C71A4ADD350CB33EEBE96CDB43F31B0EA0417DF06E85F427D0D7A2E7C2DC9A12DEA8AE719A9CEC31BB3C66386977416843D5565958A79E768CE479213D6E7B5122D552845B5EE4F79BD5980CFC810B4AF9E0563E2EBCE8312D0AD07E938706534962BA74C13A499913841540D9CB805C630CA944C2C4B3DC4A14BFA5F8F77BB01572D87CDE6E56A2241802E2983245EDAFC9760F371CC521DF98E318DD6DB21666AE731EB83026D91BE06088E592742D2C9C13AB0EE25F899190AD0448728385A1E8740D5F728AC27484F196A556B18C9C2B8B60F353FEDBBCD39142F39B5E0D7706DF971F1158B7FD06FF0CBD1B5C22D3A09FA680FB8C807F941EB82987C97491AFB20179852D3BD10B5C7FD47D6FDA8BBBCABC0FEFBD2908581C4C4C2AC35A86D38A2DF6E7DD9E5DAE953E2594D89CE06BE2EDE24F471BDDA8E956238AEA67498114AD1950466EA8AC0B570A9AD2F1AE40D737910DDB9A80A47D3C56864A6906A0D8F78687DCB8A374FABDE9C8BF5BE43FDC6EF4F00822799A34F608E9E2A36AF520CAF5B7318BAECC279A2F5434B59A86263929B55E266ACEAEB8138A84CB0E2A121E7E59E10B780623531673F1275248808DB4F1CE7C139E23D7C2AA91D21F3E0D207C86FD1B14DB2AF83272C48EA67162A45DA3091B4B8EA47C74F6E6A3FE56C5DB029798B4ECDE31BE0D1A0BB81B98CDA84D8F28E41A0FB8153BEAF9459938123E2ADF277319B0348588232B03A4E0676D3B7FDB1094EFBB290AB2652164B9E2381EB0998206092829A0BCD4D539C2C8A10C5DFF7B7130EEC3622E7C42D9D5425CF964C66C8273CB3AFB4C4182B31D5887F53EF6A615DC9DE41C1BF5D1432475E13F87F39149BDDF030414570E150ADF5700C0674FB682E4EDF510296176CF4F535B568C927558475C8DAD29FAC993F5467D6CA19378D037CC1A68E9911A6DB12D0E21A20A505CC4A153DF20EE4EFE56DFA144CF28FC5E74FD60DDEF39FA9A3CAE9C77F91F73978A4C949DF1EDCE98A909A2E32C561B4DA4074015A1DAA8593F44CCEE86F708F8C3CE9AEB75A166B51201B7989339DF099C236F0118366524380A3F57A2E09A61A1361D0B5FB8711309584C06FFE1637E9C6FCF2159AA2FE1DAFAA4E7B46F0D5E08B779F7B87B786B44C8AC47173F1FDCF1F3C7B03FA2181B2DD687D824B5DCB69F64461EBD5572631F0EC372C55CB761D2C89C9126ADC24ED6364C2BDF977A083A72A3CFA1F1A48E85ED5E02F1EE517A01676F9EBD16284333E71062E4F7517D10B46017D6B8C942675AA74EF1F535E698312230158BBC9B8979876A340CE82C3B4FF726D5EAAB2398852A7AB2B1BDBA51446ECD248DCD08DB360181DC61C791D45AFFAEB0872B07FE47BEE29398D18BFB63CBFC9DBD873BFEA8AD00F2A96A5668BD12843CB81E1D400C8AABC8CBB18936F32B47B8304FE7DE3C67CFA46B1389F287AD4521087F26AA832CEDA565786578526C05335DDD1503348CBBDFC9A16DF92F1041302ADBA2F95EA49546521B6AF8469945D80DB903C8DE6FFDAA78844F19723FC1D070AB12984412EC60A6F4723237346419BADF39F0E0B1DC3C74E70C4A053C3AC54EA22DAAB200B846AAE47ABAAB719285CF5556AC050F729D56C498FD59964520AE1EA4C9BA336E118B3E00524F33000CE466E14A5DE9E3F26BE7DE21114484AA37CAEDAC7E77EBB0A0B395E901DE8535E5AA41DE417CEB9CCA2240A5E40EC421270231D569E6B7254422C74885AE15AC8DC32FD665ACAC689F5693359D2FD267FB1B97178A12F91580A68AEDE48AF35E58DED5B775BF3DBF19BBE762FC37CCCF0FACD2790C6E8A637BA595A26BC52486B98F6D69FFE213CE95A485157574BB1649F6B30911ADEDC647D49A898ED2639ED15DD6B74E16C5C2B5E427FA34D238152F2475CF63F6E49047BB80C5A5C9B2BC9EB9E8AD89EA3ABFC617FFF53D3581C89A3F53408F0257BA0B60A288D68CDAB4D9642FB59BD255826505D2BBB0EFF0E94456517F7E8C20CE6F8380DE6D9FC498D2AFE52D1EC51EEBBFD1CCB0D0C63E8B3F0F289A25AC64BF914E7BB9BD145431B5A382EE7B2FF96CF0762CE24BB21CEA3D3EF3C1D1793B559E605C18320F62ECB41862EDB17BC932D1FA146002031FEE66ADC92001084A1790336A4462CB6605D72EE56AA18398065EF4CA1B91CC8808A5BEE498143A1A9A820370498228279C15A52D8A0CC4AD4A46DD5A1CA2CC1B007DEC6D89677CAA04B9F22F4ECEDEE4B9106CE8ACCC05F512484B15BF3FD48CB2523E2866E13809FE52FA9001D7F6965C9D99F02E7F6D3FA5534FC1707BFDFE4AF30744643B8153019B671A0CAB48620ABC90BC3D1F7FB996A363E83539A5666D063C493A0053ED5AD70FAE3804E3083B84FB16E16A05863D4144B828DC2B114AA01FEFB383E605D2722743A5BDFADB5C8BC4604AEF078CF6EFCD20052660821BB56C33E03F9400E44605E9F7FB760B624ADE885E46C6B7D4FF2F4784CB4BD85B1F3F1CC85C263B1323A611A7DB8C263751EC51FFBBA15AD13590077AA7238B57ADC48422AE5D4E9CDD44FFA098EC6407AAEFA757A38520A361CA26ABC319572247A9933F93D027F943F584DB44BC9C5B3BCA94FF46D201400318F2D5569291621F445C3447A0D13EEFED29A4C623BB54A07C3E547C7767A4DEDBDF650F17E66D994BFF00103DD77A1F1077AD76DF1BE37D02ED3D002BAD1F456D721F1AF04E679BA084E20739568DB93E802997AC1150FAFA555D7E820E1D2D063A66CB91B99F3A0F5A883016DED3606BBF0F49DB267FD33DB1D38F8876F529B4F8E50CB6F9794DC905BD2CE58EACCEE5E6F47737D226EC461DC40B06683FCD876DBFC3ACB8466037461C0112C5F102BCDAF8C8437D9674BC91C4FD59B094E506D0F2D69169A8DDAE38F5CE47E27E0B1A1EBC9B4E469E7943502C5595F5982C1463E391D10B217876460EE1F6DAC5E8E65AF2F2DDA948EA61C3E1B2E11F23BC1AEBA80CCA64650D1099459630003D25030D74B9B2B218BD6FAEF536193212BBDD3EE13300C8F65A14A5A5F567B89857FAFAE4F3DA01FBFB1FA8D5C0BF7AB2B68EAC4FC9573720E8014EBBAEAE3766456FB5B0CBE8A0672C08396B20B1F8A9CF53532DCDFE080DABC6CC94422E03358BC986B869490609BC794DD165E2E7B59690E9B1E3C32FCC281EFAD2F15DE17ADA9E4E08668E3AB80537F0FCCA302BA599BEF223A9DED3D9D1ED47A3020B40AC7618029188807389B3928FB79C00B970C1FDDD320A5793DC2FD688D917ED4B95EE8CFD84A0EDA276F1FC7A3CBA03AF5AC65F914EA02F39739CA27E2BF765852ECE4ABB4B5B80D0524B7E6243CB307EAE01803E9D1C1ADFA9D85804703FEEF55340466C39B1B1DA05FDAD6880D912CCA113BE19ECB8C5753B836CFC3586CD00B3FE3B5598D1926C1B6CF76292556216D58D8A3D40A1F38F96DE3DCB1ECC46FD6040BDE3EFE75A2B50FEBBE0475B54784E8AC87B832D4171E12B3DF2FCE26BD64C3FBEE6CEB1A19E090D6B8113D5BAD3D13AAE89A2933C1E278B9490856439BC80CEB5012F25B3FC146B0FBF4B68FD76BBC356369EEBA40140ED0C81AEB50918CDB6EA104B769728704D7547947D0B340D43468F7C07726ADE0077C64E244A89B2A33D579C0AB90252D33D11558301B8B35BA5F83FBCBC0B0E861A0478E9FBAE5FCBCA9635BF8FB33B864B391281F1F904F0B04AD2A9547D3A72172CBDF4889E0D5093477C06A863A578A1943AF67E26B3D7F9018808FFF212479DDE23342BDD1A853090A7A4D1FDF13852D29B67C5D8513A60E8D1A3243DE13BEB4D049A9CF74A3DFBFFCECF6013C0CAA4AD46E02DFE95A279BF2C761A1585FF6008B891C896E699B3C9655A7ACAFA8D5FEBB8AA3C4143A4DFCD318291FE06605A499A5BA020B65D57822271A2756FAA42BD742076DF48FB6459B27FF33D1CD53A07CFEA753D4AD40C2F89853CA8FD924D25C0ADD441682A331099EBF4C38CE1085F199F07BCCF026A4862DE097C0BFD44A742801F243554A7D7A74540B41D6E0D930148A5423990A5DFD109960F01DA55D9A012329A7509A7BFE1404D75E23B52F8EE0B5661D6E4B9751A942DDC148917F4BA22F06F67FC9F58A97C26F205C073FFE5AA9919CE10FB908199961461503C08335235563B38A287242571D2753A0EB1A98F2D50924B46F0782BA70A83C37D1A4F9C2D14711D8F13FB2B65150073BC28A31AD8DF6B8BA56166A773CA4B9EB2893A72463263B2CB816F99DC37ADAD97EBF6F2A8364DB88D95CF91C63D9EFEACD76212C2985EB31B4C502598F92174F22DE411C8F876159BFD0AA4E57EFF1CA60792FDAB9FDA7BFCBEEB1E4BE9B6983AB410C65945063ED50EB19D135B72066B9C0E4E915B2902F33E56CE374B234D9A1E0057856AB8B5562358D5A2CEB9538D226A6E3650B73B0C953012FA5C622EE3546BCDAFFF28D50B459F489636982450512A997906A106ECB057AE3FC4FAF56BEF0B3AF20AA5B8BBE375D856A3EB64446FD6F551CE1DEF8E5ED854B8E4B8801EF5EB819ADC9327467B6797F63064C4041093F84418EA5771A6168632EB34237B6B08BA67EF74D7671B0E3B258E95A5E40A40EC0734EC26B053710FB3FB4354B78D268BD548CE44FC9B2C313F9BABE2B6CA827540EBB1A1F7DE0336347172944D4DD6D1714C6F667F80D8B9D5E405B38AA581258F90A28E5E98D844AF4EC5D5540215444E358837EF1206E27A0F39CF22B284F947C69663922506F9835F79866353C80FB428660E9FC8EB26F434B365915CA328D428281C11CA6CB5442700DB38FA172E75CB2CC6DB592170E3A72DFFDA4A21843BB1807A813EDBE0EE4268C039CFCD21348EAFB3E0DFDA55A3AA5BEDAA5BF7ACE839AB061C4CBD257F0CA5B5AEC41A3E94D85BD2F60ABEE6B79CC63E635AEC94F71685530D62F98F61A6BD9FC591F16AE9BE4797F0EFC26E8DB86816DC1ECB3CAB6B47A02F03FCDC6F4CC1B9784B9F20B2A35D2E9698003EB6B4570A3F69DC235F35EA64B1A40D46EDDE30F02E7823E4C3A77FB8412B7296CFF8443C4AE9BBA03DEF319B3062C8325B9F5A092FCF37FBF1A1F3FA09191391D11BC679D768E547E75FC065731486B6A289D154BC43B196721CA42F30A2FFFD55A5B0B7186ABC2CF3174DE166AA1795D1249D0916683781D2DFE49394D95E3540260F8BA957DB3F92E8BDF4C5847556B039088ED7402465315A0EF4A94F14B10B1265DB01C7CEDAB375493BCD68DBE1D48DE3A98A6947A602105378318FB4DC238B5CA16649E493E293F81FE6277684D240835D2B383C68B3CB25E65BB16DAC942F6243ECAE2258EB0EE1C6D2FB7128F6AE299F3B490B86CE494F88A1D0A2C45ACA1B584F6D33FCE0BFA637BE0BB20353C7B6FD75C777AF87B2B020AA02179245A0D184FEC5F0ADAC9F67B2F893387F69FA8AB963E7652B4F191D3F1ADF9C47729FCAF78B1CFDDE811AE5DAF3C6C9A5F2CBFF464A893210985CA0FCA471C8917A5A79C2392B4B6941D54396F8FD88F016C2B1E37016A2EB620423D6853EB3C4B1DDD87CB6E068A3AF6F5DEC759514BB33263B58367A6E52D62FA2A1CEFBD89EC1B92C0DB9BC16511BE75DDF68781B05A6F1D15DDD757DDDEB9139CC31838A0D4EC565919ABBAD058318CDB35759E40FFCD42559082763264AC6C866C29A69E99BB5394C8818D9CC4BDA84409BC8A4B3F8FB679B6D26C28712EDA97487F8E00859697CFB0DDC0B636F927FCAAE7614F33A505FA2A3C25217B14629947C495ECBA533B7AFBCDF03589E0A5EBF3D73CE3B8225BDE6C3853C101838DA1135A96ECD52BD3E7DB29619F8362327E0D36B4F8C585E3EEA17B188E3B16945D5D73A7CC6EA312A8D00269AC010D4974C68EE795E0DB24BB16F58FF7C4A3EA44C5729CDCD7090CE4DC95D3EA310AE42162ED22255B59CFFA408EC56B87EF4EA3ECAAB6E53EAC51E8B432FFB0D57539EC6117D71347D6EF7C57CB7938E1B127CC56B96F7AF7454939F079FC4AD627C5C9B7B72CAFBB955D5C25AE3A77E65252A08DD5E8AB4EF1938DC782A8A523052A92436F9B4461A5A23F54AE7C8AD300CCA91F2F5FF0BA093942FB8E555DC4B20A92291D78A2FB71DFDDD692A478448F1C1CD07D573DA753AFBC0286B6317378D1F926C119FF1DAD16765CF74459C53BD9A1CFC8C696AB2153430C864001F83CC52AFC69B42E30EBD5A714025F0A96AC425298AE7E3893CE62DAEF4ADAF3442A88BBF1EB06079E62503E016A651E0C328DD779943C70F8C705F26142808119D71179206B4D1483CBF6C51F66FF99C0D42D6FCBF4CA55A3A9273EFF89C385277F94F10435F239A259DC43F9D01A1005F58C34D7B7F0BED815BF1294EF6E500FE0953977059F5D090517BCB3A27B52BBCC2E6DD9C375CCA91BF69382FB3ECA068FE66532D5DC246366084D74A9DADEA9321DD3B974DFF655C81F532A02B311529C568E711494C99FE7E2B9C9CB94B86F2096461C81666D0E6789C7AF7C0C461FC21919523A0F4F782A651FE1EE5DDF9FBECF3648D2D36BB5B8B880641CF40507C4A817AB24773E66EF18EFFD1C25C6E7FDD49371140AC7E9C44DD968763E910A623C07B535DD6442404A539ABD3FF38220F692ADFE6733DC6D5D7898C97EB132B3AD3D1FB7F7DE908291D847D735374CE692D7276144A79F5BCFBD146DF6D418923ACFF47CEA25081E03E2A5F69F9C1A71E69F9D97536D7391AA09DCFFFC946537DED7734FA92376306E7ACEC84949559CAD00F25C1BE779AE1F9D9050557698D2AAEF3FE538C772D8EBB98ECD0B933F4A5A2266856710270ECCAC072BFC61E9ED47DA5B7883BFCF1386697C42F6464A26C99CB23F53D0AD0657C39507DB094267FC750355B9F8E71C61CA6614168EC261A3E2254EC9E6625B3015617ACC30DDFC8D92C1C8A7FE08EEEB8C15C63BED1BC93E6138B8F5CFFACE3DBB53C2D7C298878092013247F0D2ECAB2B0EB4A4A01683D8493D64B86E8E8EC519B98ADAB419FA30CA664270F4026BD5F117745EBFD7F7363E76F1BCD941E6D472265A6CB8DDB2AF6D648C975CC25F3AFA3E0A555300FB642633A866B957A546FD9F33433D6613FB7CD75FAB4C2D79D6EDAB147E98E463A57987C2CCC92F76BD1FC8B4C6994CD60EBCA339C6A664FBF90071962004C51FB255DC901364D0AEA6AE061038167A5883DB1933B8A6C98209AB379D67D614B33000DB30F1C0B127F05BD090287E97309DE97C44C7F5208D96CE50C49CC0FA873E3E9EDF471831F02FE138D92460406A7FC46E626D42E1DEE0224923C0D119393504F078D906F50C4BD997B9D400AFEFF21195A5FA3F9C2EA777E64C147DD9B7AB1CD9D440327C056A6891F9719946C66E6DA1AA88B4461EE930AB551C6F64EDD309532AC71E5D93BC2E5A404E756F52DD02AB896BBCC0FE37A0F29DD63833C4A8E07ED0EC23C919F70D5759A27DCFDBDE819D50241DCE51EA3F4E902844A113880CBE0E513DD47A52DFA72A1EAB3D76411AE2775BCBC166EED01EC09E2BF99E276604EFF400F6B0F8F91BF574AD21F90FECCC11D2D8898CECA21F47FEDD637ED52BD730A43D531D3CB55FD548BE190E280D9E01AACEBA0EA6A91D571E337658DE64A39DAB4A069DEE66E09CD73025FA093D8B752631E378B9728AAADB41841D5227157EB8123BA372C4439E4763713143E8989250C87FE3E35BAFE6ED7962220527F0586179D291DFDC4DA625D6D4596978143D638945428F76F88AB40B7FB07A69752BCCEAA968160C2B961B0F5AEBE663E26D39DC8B7A43CD331AD1F8ADFB6258A570B2CACD4BD55E19FEF3891FB281CA8351F6D2191FDA27E68A268EB6200B1F2F2AB1ECA679C5E93F52FC65A23A4769999828A91A8183676D6944832514B1066495C3671C2B52BC0B01639C7747912B0D5B9377366FB4E281DE080925C0FAA2FF73AD335554B53D0F5F18DF74153575626A442FB7A07A11D918BBD168620B23D0D7B1BCBD0395517B5B17A0719E0B4DBF706B30E4DB8AA1306A36FAB63098170F9A6D7F52E4E5DD9B38FB3241AA7C10036201F0890ABE4E5704A192E1309A668D695AFDAE1EBFB160F44BA319D1A5D1FD182B40A715805A880B8E02A646D1E6EC0503F78C79283EB2A91609554659E51757E9B317867B9160D766D64D626A770DA0E963B6CD39D6DB32C712B6E121FEE1DB7510CDDF87D578CAC4B640037189CBDCEA87353BB08C78A7829F5BE46C259DB6D9BEFC3643E8282EAF7759A27E5DD223072306BFA5BB9A615701C7AFF418321E68CE5143ACD2FFF146EAF75AFDCFA94A4F500CAE33F6753B02991933E96F0996C2477227A8117313C13AA62AF69D0A6045A11F0DBF0455DAE5F9652FE6B12BFD05EDF8083FEEFB5E6DCBA299D16B3467C8FFF5155C1F84BA4FA216937FD0DF73C487862B04C3603AB67B2D43CEA58D0C9CD500C634F0749C18FCDB9029A1D98B0F714F5E67C14CC9C62A15D0AB9DB71B424035595BDEE503D5FDEC419D2664CC4BC8D175C0DF4CD22E5C951A045A89F53E68C69E6E2543E0E7003DB4936B265B441A2B3592E58418DEA37EAFBFDC1403A28FBCB381A8E6770E746B44E81B75AD0C54F6285E3C74EB1C5837549C4255525515C0190822A03A42897217D0A06105F81AF2152E79297298B4E631E328F0708C4BE559217DB80E6A24A187AF1DA0028A1A8D9CC2E19E4A7EE186B0310A5EE411112580A2EB2075A7B4F6CCC3A8641F75174C321D0191B1CC984451F35FC350E16530032D2529C65C9A9E54936AE2B3338A0FF46B4049412452A5CCB18D1036198A37A65BA7A9851BA7826642C6047264F5DF1395DCDB290B8BBAD6AA356DEEF0E11A97ED47A9129DA5D1466954DCDF2950021F6C1127341214EE04BA372AECEDFBBB2F953DD267153B24BD10FD3DE990651DD5225BDAAC00BFC5BFBEBE4DB262E233A73E6D443735247B36BD37E3E7C49CC307F98DCF2192F98CE965079B8071D1F4F4E50286636D0762F18D7D959D993AB74A4EBF9457E728B9C4C0A14E9815F8A452D58D128BE711B78DE5A65A4CCE5D8AB39FB1891634CA82078E7D75249548A7D7CA53EB23EE46FBD7D5C9226920384235D5D3D0BDD06EB6B0A100C2E2E99D57081F7A8500935087707F5984EB8B230851606EB1FC40B7524F647E8475B77B316AB4AD8C3899A2A487C0217522BE1B3F25768A5E2AF81BB5ABB31EA337E85791E48C4306CA588EDBBE89BA080653056E17B66CDD595FBDADCB77E4C775612E31D827C8282C22E59243D3BDE895D72D807A8414562A3FC9BCB46F39BFEAD2BF7C624FEF23D37FF22C0C870D230C620CF527DF9A34DD9081B75BABA81E5EF22950F6CA5AA2CC456014B8E1E6ABE725585C8D88B21423B636BCE2AB793394BB1DF332E44864CE8A7DD9E3CDEB044D7462D4EF3CD96CF55C354F2F192D4A2F43E2A3F6341049FA479956E5A770690565D61FF59887776F0437533E32AC67D163715436E06A1384586D76B438712CBF7371DB810EADA0A819946057A4A257BE4D8F66D42FEC7731572EA3393F80F3748EF7E09A6AB560CA45741367AB7AA2FBA6A6453BE5ABA7541C36367F77F62C2D0C0BC257AE0E6492CB4C8FD74093778D9E1B2F5BBE0F80515F8E98CF482C06D55B540B13083116C602033B660D06E2B5057E9B8ECB7781072ECA98B4D46695F6A28CDE23488D0C2999EAD34F06AF2BE8437D35EE22B952298753A0046AB0B0D542421528EF26223B6CBE481D91085ACEDEF365854BE848C7A5BD597AB868E7E2087457617DFAEBB8F271C66B70F7D6D0CE587D4292B94999B38313CAEF24BD2319C90577E929275C46084E9571FC5AC988389F759C01AB0DEC308AA55721B141074857CBB15F196DDE19543DC735DA4E387AFC9075C46B7194C6D702870565AA3";
    char expected_str[] = "0B1F93C87543DCB8FE84EC8B3058E1D5F4A1E198E43CFE1231319260900C61E33997F90A16F196EB697E6253C086003D";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA384, msg, 73888, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

/*
 *      "tcId" : 14,
 *      "msg" : "E948E48C7A9A7C3C16820CCBC640",
 *      "len" : 112
 *      "md": "CD51CFDAE765ACC6D9BEE3BF6206369E2ED0A036BE192F3F92AD0EB2CF57342BA26E09538D4428B706B13914B6A0DA85B39BAEF0DFF1B2E401AC4924BE8C429F"
 */
Test(APP_SHA_HANDLER, properly_sha512_112) {
    char msg[] = "E948E48C7A9A7C3C16820CCBC640";
    char expected_str[] = "CD51CFDAE765ACC6D9BEE3BF6206369E2ED0A036BE192F3F92AD0EB2CF57342BA26E09538D4428B706B13914B6A0DA85B39BAEF0DFF1B2E401AC4924BE8C429F";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA512, msg, 112, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

Test(APP_SHA_HANDLER, properly_sha384_37456) {
    char msg[] = "E7DDF3B965A755717BCDAFCC3026E6414A6C7B0997F8980AB24B1A46862C32D82B5CA1FB4F8945C5B9EEC31BE0C408BE28E08D8E84EB5388D84342AA6D0F603FE8909038E50F21D8FAFFF4EA81704DF4F68756E66C1A68BC95870A716140C5AED8448B2EB9FE467EC6F9A8ECA7E810E3B5A3EB33BD388474BE4A372C8EE8D1A3EC9CD291530398E2BA131EF08E2606CDB4985A32E4B14AABD6DF3151E10192E5E93712AEB6C47C0FD6CFE407E45A54EF9C182E20CDBBDBFF4A8855D0126FB19F1B034BE316A3E6E2B827EEC0B194342CB044C193A1ADE8351A29519CA63537C58F959C198704345DABCFCDB6F0F6289C25FC0549344135B71CD2E74A0091B286DEDFB6D9305929B58EF6D4D76505080274522E59BB15A4466FCD72B0B9C25380A732BBF8F89CEE5355C05FD988A5858F83A00D541259B999D8AF761EAC7E75EDCF5D7CEA948BA281A640B274AE7DF6E6EC1F2F2FAF23DD231C4F849B1E949308350D577E8C71AEB2CFBC77F07DD6E95C4B94B34086ABFB26DB085B423D723D1D302F4A98DA417B9F5FB6DAAA4AB92C7892C20E5BB2C43780A531C007100E68AA66C2A9A94E7B1E5AF06504BE2CA1589C106C51A61DA4E0DAD99913F99C6C056474064BA2563DE4E3682C00929F1019B92A5C741673DDB1B264FFE6335E8786F1F7A4CF455A82F98482C483CE5744DABFCC7280225DFD09434CA6244FC167A7ECFA57D77AD0E62BAB7FD1137C20FD58894FA89A06748149CF1E9F2C852D79569541A4CCAFCE2A686778F5A4A6CC27E3782C52C818FDE891C607A6A4384DA3A02478DFA4037684DC17C098EF06485075C2D87929CE9DCF75E5A84234AB4128FF67FBECF741EABBF2552065E772CE39093C51E6614D0B9C1070218FBF69DAFD7DA80ABD3F518DC6A939C7356BAE3F967467AB0FA8BFD109253B3D840893F5B98B8B13270943A1B54BF9A5325631D84EF52923B522668991D01301E106D9C04E6C1D6743FC35C0971CCE763151A11D261D445EC9E262D7F3CF105DC9DABE83C12BF6D47458F59353F30517FA5958A22DDDDBA08A9BEC454192BF388F89B39D34C9CF8AF3CEFA02BDCFF9B528A369B207A0E67D78F34D91B6EAA36F5BB2624DA92EBB640C5F42135A5493D72CA230E4011AEAF2D65DCCEF2EDCE935E2555750A7265858886BCDF192BCDA44E27B6EA01F86C4B2030973018744CFDA51D5D0359976539B424F6AC6CDEDFC495F5333FEB63B0AB38BF0C6FAC19BA8F3319ADF8E063A98167925DB2A3950A2C904349D303701753163D770318DCCC01E7AA4166FB7007EFC836BFF2C6C6E8AFB2253C781B92397480A978F85361C8278514898C34CC51DCBB65653CF4980C8F35CA64E0F45116613676235D5CC3452D73A49AC3461E7A270630C921F36FFAA3F6C5BBA89F3BCC2FD7CFAAAEE3581D8497589CEF4BF344F162F42CC070FE30E12506A56A47DC860093D6C69B1FDD1B22F14A2024411FBAAC300385154C6FF69E6ACA8C0E8B0ECEB78CDE0F06AF74F4E8196920779C9BABB1053069169412EEA2DD661004C5349C11C1BCCFECD0CFEC992A19382B02D4048ADF5133271090645CCADFC69C1E1F014194235B91267B02486789A6F87FB972A3F23E23D68620451D4DE667D3084422C101A7E4857806B90327B95765ADA24322B2DED040E012F978A8D397DF7E3A01BEFF54AAB2EC3572D27F13E97FA8FDE0E5C5D60D0A031225BC5AC0BAFAD938170138F0539E980908CFE8D35305CF443963CE7107953B3AAF42E332CBE4F55BB5D229A8C3E251BF66DD6B4844A26508FF16A5A0469F0A40B9FCD2B54DFEE674082D85C81EBE6AEF04150011D5F52782083131A2590D794BAA48672ED165C476FF414D6C346D4A20C90EADCFDAB489212BB41B1265D5B54599CA3558EF33FDB1D4EAC66F1643462343A7881E531305DF915652DF27A951C5A053BF7A908DD8412CF0D2E0842A777E8342BBC79B65A94944C5E6B7752AB2B7CB5A898DC1C965FF6F1373FC5C4AA5780DD7F9DA511D1029E18143F68D3764A0FD3F2B29A275568D2D1CE4BB9F9ACA88CC63EED9CBBFE6F6842C031856830C43CF039726D361EBFCB1C59A48139455F4999A89997B33B49455FE9B8E720842B754F85FE58F642355FD6A0D80444CF51FBA8520994A613C1EF9268AF6C7E966CF45EE9508B41079BA33C3FAB752BDBAE0F55367D8C79895E9F10406092E5729F821603E0F3DEA73226DE831D05B2D22FF2FB95DE1D1882F83EDC2E33732D7A275A445E475BCEAAA43454960E72C83BCE44B38E0C0CCCE4E05E5EAE9D82DC87BCEDF6E5408017E38108A1AB02F8E057ED7AB10FFAE9671D4085DF5F3E4FB246DF578FEEC9B5B57F54AE78742A0D69BFBD9DFE50C9BBDE4BDBBF9BF5006B91F97CCCB86BB89DF4ECCA7BCBD83543DCDB7AE0CAD0482F1298C2478CBEA17FFA2087ADB706E8E39F876E477FDB53A093677D3C75FB8B19A634D2A14F5824623349561F79C8AA5A18EFDB55E9EF63E539129FB021D5C9513F0176626101D37BDD5837E2C18DB333189E113E4DCB1A1D9634A223D302BA6B2C17AC2DFBC3F92A2D2821040DFA19DB3573B3DB40F569EC2E72265B2B01A4FE5C44DDDA68E9A6CB7A5234B6B7498FBC8FCD24770017B009F21516A28F747C61DFD84E9CB7A9A95AEBB4F3F0FF5C024514B5CFA76383D7AAE194831143927F6E433313BA8EA4725E7588FBD8C2919E76275A340FE2BF95F293DC402A071EE2E68CB5829DD32A9F49C5B167F8766B8721BE8B3026780C23C5D1E6E42DED3710DC81714349B35C025780AD1B058566D8780A2D6117FB6457CFFF35FAD5821FF6E0B7EC5F4EE3914F20A32B8AD0DC22FBCCBB674DE318C7C9E1C026DB037DA6830B7DF728803294DF57117ADEC54517F6DA38787B052B73D8DF6D92E2C2E9619A82F0CFE8D2FC3444376D7857F1A63773A2E9C464182874DB65CA24B476CB4CD0686C85FCB8BAE09E9D90A47A06D9A3042109AE0FB9CA0607ED88A2B29AD1D4DBE77E3094AA597D51F97E2E1F306163087DBF864BA7344F99003055350CD91CCCAFD5DC69E120C3A75455430963073743BEAF8CB79E83B0C3E812B56E01D2A73D87922668A422B7097724CF58F737ABB69E5607B316A35FD63D808C99293BCC24AE3B400FBED699C662A25BFD5AEE4474ABDFA9CDF65578C8A1E53F3EE819ABD22229473CAC57954824FE098F6B01BB7DBF74B3D50DEE4DF577ED66531FBDC46B31C7FE156B03E95EB4B7BC444BF0B508385EFCAD85DD99203FB34096B54A00E042547F2109F3DBBB2238B3A70F8CA8B7831B9D1F9E07C0B0E8080947BF0C97685FCBD1F4A73924D67D9AB5458E812948FAFFA24CB25FAC1348265A2ECA5856D77E422938D5A3B726684F7E4A1B08D74236D39F15E315AA8804A6975E5F8D26FBE4D04E66C45F1C9A1585625CE7B1BAE085BABBF0543BA7CDA8EE98F13DCCACCAAC66FBD5E95DFDF1C4F4518BE252769D97D42B0B57D261E0A537C3C251E08E661144AF5E4E52B4B1C512C3B61B4C056CB0E9D1CC33BD0F5BC44A279D0EC20487AA6CD7E7BF278769A05EC8672E262ACCD5D284556739D3E82C6E85D5BB55108E7AF1DC4619DA3F353F390506A63CCA4A20E2F31E507E7887B3F0C2FE5CC6A2A5656EA3F8714AAFC9F1D5D3E0C086D9EF6DE29C5EFB75FC1EEA4D91C8A4300A1219C58D7F2B372CBC41EF944D9C63D444B9662F67D9BC6BF2EECF309D07F1B88523704395CB93559D49751B6667EBED1BEB99B95CB62E835D5A581281D476325D56FC398A7EC0DE72C3E6955C1AC54B01500513394E0F825DFAC255A9051983DED2352CB3EC3E20FFD3076C388B7D1FAF02189A5854049282AF26C89EBFB17A2F1F21D939754E1AEB5E683EE0923183C261155A8048A300AC6FA201072A7E6811E8FE6A0E4080C55D99E3FB55B00125B02DF21D28C2632E89301ABA3BABB3CF59BDEFE2B7E2B0B57E3D1DE3772D30C629DDADBAF9D82601CBB54CBFF5FF037B7D5A2885762B025DE8ECF54EC42EE3D6F00FB93E27302A8243660DB94099A2748CE2125A0320D6E31BD4EB235B6967D96F8C5898748F5D8FB52CA54D0E1E32D31051B82C07536348A82ECD85C0DFAFE9B31CD7726CB2C5440E1AAE67697E11E959AB030A531BF547FFC54A3AD36CA964930FCB20078B7F145B0B47FD9A620EF368A1F1694443F87E3CDFFDECC7214F551749CA7871798B4A14484D4C993227FCB1125B23C1C1AD5E873C9993D5945CA957E130C25FC005C3C5B22AF1A180BBD673D38023CBA736480B2938763D50FD3F39EFCC55099AD0323526CAF809B987C0B2D7E3D3D3969924363A5C30F23AEA8FAB34AA29406EAE56A653BA64CB6D82685A2BB128E0A873E4180DC3B7F17785EF8B95658C21E2EB64FFC47B467BB131F9F24DA7782A762511C0CC0B2CD2AE1B229A3516FC6774B502A4DB9E06B933B0243A96650C9A2024A192CC00D6E490409ECA357A2CD66B8F585A42994F18B7DEC0A2EFBD124CE5581561EC67F7CD0F443D2BB6BD97F45313F7A8B2F1F235868EFAC3CDE628CE6B5588CD6E80E962380A4B34CFD5A6B1A28E89188B7EA16D2684E1D6CA2FD75B790D015D6F3983DD2B8227535F19B96764C4F3A542A1DB6CB2F807F25D15E45F5EAB4D893D0B769534CBB966EB53652D763FEBAE8F3507C7963F68E6CFB7A9E5E812A7C54630A6507383DB496871AB1BDED7A907FACC72057194B9E45BE9180F1522D7976E44052046E67B013B795B4F23C3CFE8C7BF07C0A9160A4C50ED36EE8517C2C4C1CFDEADBF71C6028C1C1C7BE00AD292D79E26D8E699674DF1C5910CE9081E58F43C5AF556A786EE98EE591064FB11E1F920F7A36FB7011BC53554465F5EF1E62D8177F2EBCCB2CF419690E8B42C82460BF06BDAEE4BD96C2E45C10876C88428D60D3DE7421DD265FAE5EE49233061873DCB0FE487C8F46A68B90FBD31ADB430DFB41815B3C0111BD4F2A3E2B642263E03F2B52BF964DCEF23F1A85338A6579DC8A58B496E647AF3F6084864B7175C100D4764884B7DD56BFE877A2EB407241D565AFA12523385687B01A8CFCFDB769E1F5C5B5CC3ADF8C3B7DE7DF4CDF5F49ED7183F2EB67C6C69A4283643408D497C7B4724A8A6FC359589B08EBF9D2A90B244E95D1957F1E644050258F9438273469D1B1E5DA73987353196209CC0726BFC2179C5B4D4E79799A5CCE22E31662CA94D4F310926B22B0A9D3100EE8B8C10E73089606F2BC196CF244510D34425663285AB29D0599C8681E9F1766AB7BBDEB69F26539799B15576208BA5AD3415FC139CB7A96A42B00E8421F9218038B65AC9F245E9403903EA2F156B816720A77B0B72AF211285D1FB89678C9B83E06BE2A1F2C655AF216EC2BDCA2E3B3E397511BC7C02EC1B574D9047F40AAFFBC1B45E51AABADC3164F70E5ECA795F1518F09416885C373EBC8C5CCFF8B9A72FCD8D362944532ECD8C9918B441A8A8B31D88019C3A7D89F8DDA2A4D88869CB7DAB4F07732C7C9D1A8DCE94115415E16165E438C337537FD40063A6E26EBB9C20AB6DC923090D98554B38F0B951895B84841394248976EA75721081C5D2E9537D87E59BB0996674FA09C23A22C9F2E5812879CCC1392306461D63897E08A218865BB9AB370B84FD50D4CE488FBD08D8FC8E8967EA6FAE37331CA63497B648C85252F72AA1EE740A90633B6F715623ED52FA40C6D0F46A7E855B99AB1514618C433F9FB3AB5BD33C55595C54EE3492CCC8BC49F8438C08F205A386742AC964ECB82AA30323EBA99CF38352D8E76F210BCFC4757A0119B6E643C39E55F7C6C0A83243C40F3F62913D364B11FA724BB5A3F87D3AEB71962F7C39E366B429E0E7057EC5249C1319890AAFE7103095F0CAAA78C735DFCB3E6D56E0D729C96D4024477CA7EA3CF52E6B2D5D062ADFED0F5362ADD3F54E2764AC690219CB7F47E711D9C6FD40E953777D6D155C4478A87070AB5670B17E1AEB44BC913EB4739B818AA17ED2505DBAAAD35E520F396C203EA7B68D6601D18990AC165BFB9426D6CF7D4FC864B65026FD1258413B0EC602A0B726648A4319D152063523775BCC03159A60D63C0CD8640C41D080D22490C6CF8EB6C8973B7030538CD53D1B5C68CD922B66CBD49690567FBDA0FA736C5D2844517FDF295E2E7B65356CCD635822AD3B44ED304CD4174F6DDF27C5B7D666C05938963D0AA3127F5BB2A0ECE5FD36A68358D1DA2DB760DA8F8A833BDE8A2E062151CB9AFFA6050D1E1AE7ADAFA6D9F01B0550E6DC871124D295E30FB0309943604F92BEEE51ACD33EAD613EDB33707399346B77CD8E55B410B9ECAB7943BA8058C3E01F197224867C1D74323C22DDBE415D526BB0F207406EAC3112D828F1B2E09D61B8F2B1D1EB9F1C69D4CFC46041CBC4D46BF59B1DBA7CD3D0EA5EC4A3E6F243F69C64A88316C94807CEAC83133F978FD67B0FE4F6D63AC56176C79A34A6EA1658E203F8D1A140E34FEC72587FDE499885926B8DFC4A26FA94364AC4FA193479272C615CD71C2241090B2F1DD1CFFBAC3AC1B369201142B93FDB14F4E349EF7F0943287B8A835A39FC8B9F3F0466D6A92A2E0DEA983EBC4FA8ECE032561E";
    char expected_str[] = "6150BDCE00744DD465642F8564E94E7515C4588D4B3F9966EF593F9EA71DDC8256C21BE3C427502C4D4F2A50CDDB4F05CDC08DBD319F0E813E2F092558378016";
    char *tmp = calloc(ACVP_HASH_MD_STR_MAX + 1, sizeof(char));
    hash_tc = calloc(1, sizeof(ACVP_HASH_TC));
    
    if (!initialize_sha_tc(hash_tc, ACVP_HASH_SHA512, msg, 37456, ACVP_HASH_TEST_TYPE_AFT, 0)) {
        cr_assert_fail("hash init tc failure");
    }
    test_case = calloc(1, sizeof(ACVP_TEST_CASE));
    test_case->tc.hash = hash_tc;
    
    app_sha_handler(test_case);
    
    acvp_bin_to_hexstr(test_case->tc.hash->md, test_case->tc.hash->md_len, tmp, ACVP_HASH_MD_STR_MAX);
    cr_assert(!(strncmp(expected_str, tmp, test_case->tc.hash->md_len)));
    
    free_sha_tc(&hash_tc);
    free(test_case);
    free(tmp);
}

